cmake_minimum_required(VERSION 3.20)
project(uWebSockets LANGUAGES CXX)

# Search dependencies
find_package(OpenSSL REQUIRED)
if(NOT TARGET uSockets)
    find_package(uSockets REQUIRED)
endif()

# Header-only library
add_library(uWebSockets INTERFACE)
add_library(uWebSockets::uWebSockets ALIAS uWebSockets)

# Compile definitions
target_compile_definitions(uWebSockets INTERFACE
    UWS_NO_ZLIB
)

# Include directories
target_include_directories(uWebSockets INTERFACE
    $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/src>
    $<INSTALL_INTERFACE:include>
)

# Link libraries
target_link_libraries(uWebSockets INTERFACE
    uSockets::uSockets
    OpenSSL::SSL
    OpenSSL::Crypto
)
