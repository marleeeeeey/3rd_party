<!DOCTYPE html>
<html lang="en">
<body>

<input id="input" type="text" placeholder="Type and press Enter" style="width: 100%">
<pre id="log"></pre>

<script>
    const log = msg => {
        document.getElementById("log").textContent += msg + "\n";
    };

    const input = document.getElementById("input");

    const ws = new WebSocket("wss://localhost:9001");
    // const ws = new WebSocket("ws://localhost:9001");

    ws.onopen = () => {
        log("connected");
        input.focus();
    };

    // Log on receive
    ws.onmessage = event => {
        log("recv: " + event.data);
    };

    ws.onclose = () => log("closed");
    ws.onerror = () => log("error");

    // Send on Enter
    input.addEventListener("keydown", e => {
        if (e.key === "Enter" && ws.readyState === WebSocket.OPEN) {
            const text = input.value.trim();
            if (text.length > 0) {
                ws.send(text);
                log("sent: " + text);
                input.value = "";
            }
        }
    });
</script>

</body>
</html>
